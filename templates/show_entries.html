{% extends "layout.html" %}
{% block body %}
  <form action="{{ url_for('add_entry') }}" method="post" class="add-entry">
    <dl>
      <dt>Title:
      <dd><input type="text" size="30" name="title">
        <dt>Category:
        <dd><input type="text" name="categories">
      <dt>Text:
      <dd><textarea name="text" rows="5" cols="40"></textarea>
      <dd><input type="submit" value="Share">
    </dl>
  </form>
    <form action="{{ url_for('show_entries') }}" method="get">
        <label>Filter</label>
            <select name="category" id="category">
                <option value="">Show All</option>
                {% for cat in categories %}
                <option value="{{ cat }}" {% if cat == selected %}selected{% endif %}>{{ cat }}</option>
                {% endfor %}
            </select>
        <input type="submit" value="Filter">
    </form>
  <ul class="entries">
  {% for entry in entries %}
    <li>
        <h2>{{ entry.title }}</h2>
        <h3>{{ entry.categories }}</h3>
        <p>{{ entry.text|safe }}</p>
    <form action = '{{ url_for('delete_entry',entry_id=entry.id) }}' method='post'>
        <input type="submit" value="delete">
    </form>

    <button onclick = "toggleForm('edit-{{ entry.id }}')">Edit</button>
    <form id = 'edit-{{ entry.id }}' action = "{{ url_for('edit_entry', entry_id=entry.id) }}" method="post" style = "display:none;">
        <ul>
            <li><label>Title</label>
            <input type="text" name="title" value = "{{ entry.title }}">
            </li>
            <li><label>Text</label>
            <textarea name = "text">{{ entry.text }}</textarea>
            </li>
            <li><label>Category</label>
            <input type="text" name="category" value = "{{ entry.category }}">
            </li>
            <li><button type = "submit">Save Changes</button></li>
        </ul>
    </form>

    </li>
    <script>
    function toggleForm(formId){
        const form = document.getElementById(formId)
        if (form.style.display === "none") {
            form.style.display = "block";
        }   else {form.style.display = "none";}


    }
    </script>
  {% else %}
    <li><em>Unbelievable.  No entries here so far</em></li>
  {% endfor %}
  </ul>
{% endblock %}
